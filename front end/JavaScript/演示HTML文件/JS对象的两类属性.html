<link rel="stylesheet" href="base.css">

<button onclick="getOwnPro()">内置函数getOwnPropertyDescriptor获取数据属性的特征值</button>
<button onclick="definePro()">defineProperty改变属性特征</button>
<button onclick="defineProperty_setter()">defineProperty设置访问器属性</button>

<script>
function getOwnPro()
{
  // 数据属性具有4个特征
  var o = { a : 1 };
  o.b = 2;
  // 可以使用内置函数getOwnPropertyDescriptor来查看
  console.log(Object.getOwnPropertyDescriptor(o,"a")); // {value: 1, writable: true, enumerable: true, configurable: true}
  console.log(Object.getOwnPropertyDescriptor(o,"b")); // {value: 2, writable: true, enumerable: true, configurable: true}
}

function definePro()
{
  var o = { a : 1 };
  // Object.defineProperty 可以改变特征值
  Object.defineProperty(o, "b", {value: 2, writable:false, enumerable:false, configurable:true});
  console.log(Object.getOwnPropertyDescriptor(o, "a")); // {value: 1, writable: true, enumerable: true, configurable: true}
  console.log(Object.getOwnPropertyDescriptor(o, "b")); // {value: 2, writable: false, enumerable: false, configurable: true}
  o.b = 3;
  console.log(o.b); // 2
}

// object.defineProperty 使用 get 和 set 关键字来创建访问器属性
function defineProperty_setter()
{
  var o = { a : 1 };
  // 不能同时指定访问器属性和值或可写属性writable
  Object.defineProperty(o, "b", { enumerable : false, get: () => { return o.a + "get";}, set : (value) => { o.a = value; } });
  console.log(o.b); // 1get
  o.b = 3;
  console.log(o.b); // 3get
  console.log(o.a); // 3
}
</script>